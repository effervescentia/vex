# syntax=docker/dockerfile:1-labs
FROM oven/bun:1.3-alpine
WORKDIR /home/bun/app

ARG WORKSPACE_TARGET

ARG ENTRYPOINT_CMD
ENV ENTRYPOINT_CMD=$ENTRYPOINT_CMD

COPY package.json bun.lock ./
COPY --parents */*/package.json ./

RUN bun install --frozen-lockfile

COPY . .

WORKDIR "/home/bun/app/apps/$WORKSPACE_TARGET"

EXPOSE 8080/tcp
ENTRYPOINT [ "bun", "dev" ]
